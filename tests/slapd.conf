## Copyright (c) 2025 OpenInfra Foundation Europe and others.

include                 @SCHEMADIR@/core.schema
include                 @SCHEMADIR@/cosine.schema
include                 @SCHEMADIR@/inetorgperson.schema
include                 @SCHEMADIR@/openldap.schema
include                 @SCHEMADIR@/nis.schema

#mod#modulepath         ../servers/slapd/back-@BACKEND@/
#mod#moduleload         back_@BACKEND@.la
#ppolicymod#modulepath  ../servers/slapd/overlays/
#ppolicymod#moduleload  ppolicy.la

database                @BACKEND@
suffix                  "dc=example,dc=com"
rootdn                  "cn=Manager,dc=example,dc=com"
rootpw                  secret
#null#bind              on
#~null~#directory       @TESTDIR@/db.1.a
#indexdb#index          objectClass     eq
#indexdb#index          cn,sn,uid       pres,eq,sub

access                  to attrs=userpassword
                        by self write
                        by anonymous auth
                        by * none

overlay                 ppolicy
ppolicy_default         "cn=default,ou=policies,dc=example,dc=com"
ppolicy_check_module    ../../check_password.so
ppolicy_use_lockout
